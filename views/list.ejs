 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project</title>
    <link rel="stylesheet" href="/css/style.css">
 </head>
 <body>
    <div class="box">
        <h1>TODO LIST</h1>

        <% dayej.forEach(function(task,index) { %>
            <div class="item">
                <input type="checkbox" id="task-<%= index %>">
                <label for="task-<%=index %>"><%= task.name %></label>

                <button class="option1" onclick="editTask('<%= task._id %>','<%= task.name %>')">Edit-Task</button>

                <form action="/delete/<%= task._id %>?_method=DELETE" method="POST" style="display:inline;" onsubmit="return confirmDelete()">
                 <button type="submit" class="delete-btn">Delete</button>
                </form>
                
        </div>
            <% }); %>

            <form  action="/" method="Post">
                <input type="text" name="elel" placeholder="enter item" required>
                <button type="submit">+</button>
            </form>
    </div>
    <script>
        async function editTask(id,oldName){
            const newName = prompt("Edit task:",oldName);
            if (newName && newName.trim() !=="") {
                const res = await fetch (`/update/${id}?_method=PUT`,{
                   method:"POST",
                   headers:{"Content-Type":"application/json"},
                   body:JSON.stringify({name:newName}) 
                })
                if (res.ok){
                    location.reload();
                }else{
                    alert("update failed.please try")
                }
            }
        }
        function confirmDelete(){
            return confirm("Are you sure,you want to delte this task?")
        }
    </script>
 </body>
 </html>
